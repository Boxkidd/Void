<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Void: Bestiary & Forge</title>
    <style>
        :root { 
            --cyan: #00f2ff; --onyx: #050505; --purple: #bc13fe; 
            --gold: #ffd700; --red: #ff4444; --active-color: var(--cyan);
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body { 
            background-color: var(--onyx); color: white; margin: 0; 
            font-family: 'Inter', system-ui, sans-serif; overflow: hidden;
            display: flex; flex-direction: column; height: 100vh;
        }

        #top-nav { padding: 15px; text-align: center; flex: 0 0 auto;}
        #essence-count { font-size: 2.8rem; color: var(--active-color); text-shadow: 0 0 15px var(--active-color); font-weight: 900; }
        
        /* Boss Bestiary Styles */
        #boss-zone { height: 120px; display: flex; flex-direction: column; align-items: center; justify-content: center; margin: 10px 0; display: none;}
        #boss-sprite { font-size: 4rem; text-shadow: 0 0 20px var(--red); animation: float 3s infinite ease-in-out; }
        #boss-hp-container { width: 70%; height: 12px; background: #111; border: 1px solid var(--red); border-radius: 6px; overflow: hidden; margin-top: 10px; }
        #boss-hp-bar { height: 100%; width: 100%; background: var(--red); transition: width 0.1s; }
        #boss-name { font-size: 0.6rem; text-transform: uppercase; letter-spacing: 2px; color: var(--red); font-weight: 900; margin-top: 5px;}

        #game-area { flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; position: relative; }
        #dice-floor { display: flex; gap: 15px; justify-content: center; min-height: 80px; }
        
        .die { 
            width: 70px; height: 70px; border: 3px solid var(--active-color); 
            display: flex; align-items: center; justify-content: center; 
            font-size: 1.8rem; border-radius: 15px; background: #000; transition: 0.1s;
        }
        .die.rolling { transform: scale(1.2) rotate(15deg); border-color: white; }
        .die.crit { border-color: var(--gold); color: var(--gold); box-shadow: 0 0 20px var(--gold); }

        .tab-bar { display: flex; background: #080808; border-top: 1px solid #222; flex: 0 0 auto; overflow-x: auto;}
        .tab { flex: 1; text-align: center; padding: 15px; font-size: 0.6rem; color: #555; font-weight: 900; cursor: pointer; text-transform: uppercase; min-width: 90px;}
        .tab.active { color: white; border-bottom: 2px solid var(--active-color); background: #111;}
        
        .panel { display: none; padding: 20px; height: 40vh; overflow-y: auto; background: #080808; }
        .panel.active { display: block; }
        .row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; padding: 12px; background: #0c0c0c; border-radius: 10px; border: 1px solid #222; }
        .btn { color: var(--active-color); border: 1px solid var(--active-color); padding: 8px 12px; border-radius: 6px; font-size: 0.7rem; cursor: pointer; background: transparent; font-weight: 900; }
        .btn:disabled { opacity: 0.2; cursor: default; }

        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
    </style>
</head>
<body>

    <div id="top-nav">
        <div id="essence-count">0</div>
        <div style="font-size:0.7rem; color:#666; font-weight:bold; margin-top:5px;">
            SHARDS: <span id="shard-val" style="color:var(--purple)">0</span> | 
            BUFF: <span id="skin-label" style="color:var(--gold)">STABLE</span>
        </div>
    </div>

    <div id="game-area">
        <div id="boss-zone">
            <div id="boss-sprite">ðŸ‘¾</div>
            <div id="boss-name">VOID REAVER</div>
            <div id="boss-hp-container"><div id="boss-hp-bar"></div></div>
        </div>
        <div id="dice-floor" onclick="manualRoll()"></div>
    </div>

    <div class="tab-bar">
        <div class="tab active" onclick="tab('upgrades')">Upgrades</div>
        <div class="tab" onclick="tab('forge')">Forge</div>
        <div class="tab" onclick="tab('armory')">Armory</div>
        <div class="tab" onclick="tab('store')">Store</div>
    </div>

    <div class="panel active" id="upgrades">
        <div class="row"><div>Evolution<br><small id="ev-label">D6</small></div><button id="btn-ev" class="btn" onclick="buy('ev')">1k</button></div>
        <div class="row"><div>Die 1 Auto<br><small id="a1-label">Lvl 0</small></div><button id="btn-a1" class="btn" onclick="buy('a1')">500</button></div>
        <div class="row"><div>Die 2 Auto<br><small id="a2-label">Lvl 0</small></div><button id="btn-a2" class="btn" onclick="buy('a2')">5k</button></div>
        <div class="row"><div>Die 3 Auto<br><small id="a3-label">Lvl 0</small></div><button id="btn-a3" class="btn" onclick="buy('a3')">50k</button></div>
        <button id="boss-spawn-btn" class="btn" style="width:100%; border-color:var(--red); color:var(--red)" onclick="spawnBoss()">BREACH CORE (10k)</button>
    </div>

    <div class="panel" id="forge">
        <div id="forge-list"><p style="text-align:center; color:#444; padding:20px;">Relics drop from Bosses.</p></div>
    </div>

    <div class="panel" id="armory">
        <div class="row"><div>Void Gauntlet (+50%)</div><button id="gear-0" class="btn" onclick="craft(0)">10 S</button></div>
        <div class="row"><div>Singularity Core (2x)</div><button id="gear-1" class="btn" onclick="craft(1)">100 S</button></div>
        <div class="row"><div>Omni-Visor (5x Crit)</div><button id="gear-2" class="btn" onclick="craft(2)">500 S</button></div>
        <div class="row"><div>Reality Blade (10x Boss)</div><button id="gear-3" class="btn" onclick="craft(3)">1k S</button></div>
    </div>

    <div class="panel" id="store">
        <div class="row"><div>Cyan Void (1.2x Auto)</div><button class="btn" onclick="setSkin('cyan')">EQUIP</button></div>
        <div class="row"><div>Ghostly Void (5x Crit)</div><button class="btn" onclick="setSkin('ghostly')">EQUIP</button></div>
        <div class="row"><div>Gold Void (1.5x Ess)</div><button class="btn" onclick="setSkin('gold')">EQUIP</button></div>
    </div>

    <script>
        let s = {
            e: 0, shards: 0, kills: 0, ev: 0,
            autos: [0, 0, 0],
            relics: [], relicLevels: {},
            gear: [false, false, false, false],
            skin: 'cyan', bossActive: false, bHP: 0, bMax: 0
        };

        const DICE_DATA = [6, 12, 20, 50, 100];
        const RELIC_META = { "ðŸ”¥": "Infernal", "â„ï¸": "Frozen", "âš¡": "Pulse", "ðŸ‘ï¸": "Oracle" };
        const BOSS_SPRITES = ["ðŸ‘¾", "ðŸ›¸", "ðŸŒ‘", "ðŸ§¿", "ðŸ‘¹"];
        const BOSS_NAMES = ["Void Reaver", "Star Eater", "Singularity", "Null Husk", "Ender"];

        function tab(t) {
            document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(x => x.classList.remove('active'));
            document.getElementById(t).classList.add('active');
            event.target.classList.add('active');
        }

        function initDice() {
            const floor = document.getElementById('dice-floor');
            floor.innerHTML = '';
            for(let i=0; i<3; i++) {
                let d = document.createElement('div');
                d.className = 'die'; d.id = `die-${i}`; d.innerText = '?';
                floor.appendChild(d);
            }
        }

        function rollDie(idx) {
            const d = document.getElementById(`die-${idx}`);
            if(!d) return;
            d.classList.add('rolling');
            
            setTimeout(() => {
                let side = DICE_DATA[s.ev];
                let val = Math.floor(Math.random() * side) + 1;
                let isCrit = Math.random() < 0.1;
                d.innerText = val; d.classList.remove('rolling');
                d.className = `die ${isCrit ? 'crit' : ''}`;

                let mult = (isCrit ? (s.skin === 'ghostly' ? 50 : 10) : 1);
                if(s.gear[2] && isCrit) mult *= 5;

                // Add Forge Multipliers
                Object.values(s.relicLevels).forEach(lvl => mult += (lvl * 0.5));

                let gain = val * mult * (s.gear[0]?1.5:1) * (s.gear[1]?2:1) * (s.skin === 'gold'?1.5:1);
                s.e += gain;

                if(s.bossActive) {
                    let dmg = val * (s.gear[3]?10:1);
                    s.bHP -= dmg;
                    document.getElementById('boss-hp-bar').style.width = (s.bHP/s.bMax)*100 + "%";
                    if(s.bHP <= 0) winBoss();
                }
                updateUI();
            }, 100);
        }

        function manualRoll() { rollDie(0); rollDie(1); rollDie(2); }

        function buy(type) {
            let cost = 0;
            if(type === 'ev') cost = 1000 * Math.pow(10, s.ev);
            if(type === 'a1') cost = 500 * Math.pow(2, s.autos[0]);
            if(type === 'a2') cost = 5000 * Math.pow(2, s.autos[1]);
            if(type === 'a3') cost = 50000 * Math.pow(2, s.autos[2]);

            if(s.e >= cost) {
                s.e -= cost;
                if(type === 'ev' && s.ev < 4) s.ev++;
                if(type === 'a1') s.autos[0]++;
                if(type === 'a2') s.autos[1]++;
                if(type === 'a3') s.autos[2]++;
                updateUI();
            }
        }

        function forge(r) {
            let cost = (s.relicLevels[r] || 1) * 10000;
            if(s.e >= cost) {
                s.e -= cost;
                s.relicLevels[r] = (s.relicLevels[r] || 0) + 1;
                updateUI();
            }
        }

        function spawnBoss() {
            if(s.e >= 10000 && !s.bossActive) {
                s.e -= 10000; s.bossActive = true;
                s.bMax = 1000 * (s.kills + 1); s.bHP = s.bMax;
                let id = Math.floor(Math.random()*5);
                document.getElementById('boss-sprite').innerText = BOSS_SPRITES[id];
                document.getElementById('boss-name').innerText = BOSS_NAMES[id];
                document.getElementById('boss-zone').style.display = 'flex';
                updateUI();
            }
        }

        function winBoss() {
            s.bossActive = false; s.kills++; s.shards += 10;
            document.getElementById('boss-zone').style.display = 'none';
            let rKey = Object.keys(RELIC_META)[Math.floor(Math.random()*4)];
            if(!s.relics.includes(rKey)) s.relics.push(rKey);
            updateUI();
        }

        function craft(id) {
            let costs = [10, 100, 500, 1000];
            if(s.shards >= costs[id] && !s.gear[id]) { s.shards -= costs[id]; s.gear[id] = true; updateUI(); }
        }

        function setSkin(id) {
            s.skin = id;
            document.documentElement.style.setProperty('--active-color', (id==='cyan'?'#00f2ff':id==='ghostly'?'#bc13fe':'#ffd700'));
            updateUI();
        }

        function updateUI() {
            document.getElementById('essence-count').innerText = Math.floor(s.e).toLocaleString();
            document.getElementById('shard-val').innerText = s.shards;
            document.getElementById('ev-label').innerText = "D" + DICE_DATA[s.ev];
            document.getElementById('a1-label').innerText = "Lvl " + s.autos[0];
            document.getElementById('a2-label').innerText = "Lvl " + s.autos[1];
            document.getElementById('a3-label').innerText = "Lvl " + s.autos[2];

            document.getElementById('btn-ev').innerText = (1000 * Math.pow(10, s.ev)).toLocaleString();
            document.getElementById('btn-a1').innerText = (500 * Math.pow(2, s.autos[0])).toLocaleString();
            document.getElementById('btn-a2').innerText = (5000 * Math.pow(2, s.autos[1])).toLocaleString();
            document.getElementById('btn-a3').innerText = (50000 * Math.pow(2, s.autos[2])).toLocaleString();

            if(s.relics.length > 0) {
                document.getElementById('forge-list').innerHTML = s.relics.map(r => `
                    <div class="row">
                        <div>${RELIC_META[r]} (Lvl ${s.relicLevels[r]||0})</div>
                        <button class="btn" onclick="forge('${r}')">${((s.relicLevels[r]||1)*10000).toLocaleString()}</button>
                    </div>
                `).join('');
            }
            localStorage.setItem('void_save_v2', JSON.stringify(s));
        }

        // Auto Roll Loops
        setInterval(() => { if(s.autos[0] > 0) rollDie(0); }, (2000 / (s.autos[0] || 0.001)) * (s.skin==='cyan'?0.8:1));
        setInterval(() => { if(s.autos[1] > 0) rollDie(1); }, (4000 / (s.autos[1] || 0.001)) * (s.skin==='cyan'?0.8:1));
        setInterval(() => { if(s.autos[2] > 0) rollDie(2); }, (6000 / (s.autos[2] || 0.001)) * (s.skin==='cyan'?0.8:1));

        window.onload = () => {
            let saved = localStorage.getItem('void_save_v2');
            if(saved) s = Object.assign(s, JSON.parse(saved));
            initDice(); setSkin(s.skin); updateUI();
        };
    </script>
</body>
</html>