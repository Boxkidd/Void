<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Void: Reborn</title>
    <style>
        :root { 
            --cyan: #00f2ff; --onyx: #050505; --purple: #bc13fe; 
            --gold: #ffd700; --red: #ff4444; --active-color: var(--cyan);
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body { 
            background-color: var(--onyx); color: white; margin: 0; 
            font-family: 'Inter', system-ui, sans-serif; overflow: hidden;
            display: flex; flex-direction: column; height: 100vh;
        }

        #top-nav { padding: 15px; text-align: center; flex: 0 0 auto;}
        #essence-count { font-size: 2.8rem; color: var(--active-color); text-shadow: 0 0 15px var(--active-color); font-weight: 900; }
        
        #boss-container { width: 80%; height: 20px; background: #111; margin: 10px auto; border: 1px solid var(--red); display: none; position: relative; border-radius: 10px; overflow: hidden;}
        #boss-hp { height: 100%; width: 100%; background: var(--red); transition: width 0.1s; }

        #game-area { flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; position: relative; }
        #dice-floor { display: flex; gap: 15px; justify-content: center; min-height: 80px; }
        
        .die { 
            width: 70px; height: 70px; border: 3px solid var(--active-color); 
            display: flex; align-items: center; justify-content: center; 
            font-size: 1.8rem; border-radius: 15px; background: #000; 
            transition: transform 0.1s, border-color 0.3s;
        }
        .die.rolling { transform: scale(1.2) rotate(15deg); border-color: white; }
        .die.crit { border-color: var(--gold); color: var(--gold); box-shadow: 0 0 20px var(--gold); }

        .tab-bar { display: flex; background: #080808; border-top: 1px solid #222; }
        .tab { flex: 1; text-align: center; padding: 15px; font-size: 0.6rem; color: #555; font-weight: 900; cursor: pointer; text-transform: uppercase;}
        .tab.active { color: white; border-bottom: 2px solid var(--active-color); background: #111;}
        
        .panel { display: none; padding: 20px; height: 40vh; overflow-y: auto; background: #080808; }
        .panel.active { display: block; }
        .row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; padding: 12px; background: #0c0c0c; border-radius: 10px; border: 1px solid #222; }
        .btn { color: var(--active-color); border: 1px solid var(--active-color); padding: 8px 12px; border-radius: 6px; font-size: 0.7rem; cursor: pointer; background: transparent; font-weight: 900; }
        .btn:disabled { opacity: 0.2; filter: grayscale(1); }
    </style>
</head>
<body>

    <div id="top-nav">
        <div id="essence-count">0</div>
        <div id="boss-container"><div id="boss-hp"></div></div>
        <div style="font-size:0.7rem; color:#666; font-weight:bold; margin-top:5px;">
            SHARDS: <span id="shard-val" style="color:var(--purple)">0</span> | 
            BUFF: <span id="skin-buff-label" style="color:var(--gold)">NONE</span>
        </div>
    </div>

    <div id="game-area">
        <div id="dice-floor" onclick="manualRoll()"></div>
        <div id="od-btn" class="btn" style="margin-top:20px; display:none;" onclick="triggerOverdrive()">OVERDRIVE</div>
    </div>

    <div class="tab-bar">
        <div class="tab active" onclick="tab('upgrades')">Upgrades</div>
        <div class="tab" onclick="tab('forge')">Forge</div>
        <div class="tab" onclick="tab('armory')">Armory</div>
        <div class="tab" onclick="tab('store')">Store</div>
    </div>

    <div class="panel active" id="upgrades">
        <div class="row"><div>Evolution<br><small id="ev-label">D6</small></div><button id="btn-ev" class="btn" onclick="buy('ev')">1k</button></div>
        <div class="row"><div>Die 1 Auto<br><small id="a1-label">Lvl 0</small></div><button id="btn-a1" class="btn" onclick="buy('a1')">500</button></div>
        <div class="row"><div>Die 2 Auto<br><small id="a2-label">Lvl 0</small></div><button id="btn-a2" class="btn" onclick="buy('a2')">5k</button></div>
        <div class="row"><div>Die 3 Auto<br><small id="a3-label">Lvl 0</small></div><button id="btn-a3" class="btn" onclick="buy('a3')">50k</button></div>
        <button class="btn" style="width:100%; border-color:var(--purple); color:var(--purple)" onclick="spawnBoss()">BREACH CORE (10k)</button>
    </div>

    <div class="panel" id="forge">
        <div id="forge-list"></div>
    </div>

    <div class="panel" id="armory">
        <div class="row"><div>Void Gauntlet (+50%)</div><button id="gear-0" class="btn" onclick="craft(0)">10 S</button></div>
        <div class="row"><div>Singularity Core (2x)</div><button id="gear-1" class="btn" onclick="craft(1)">100 S</button></div>
        <div class="row"><div>Omni-Visor (5x Crit)</div><button id="gear-2" class="btn" onclick="craft(2)">500 S</button></div>
    </div>

    <div class="panel" id="store">
        <div class="row"><div>Cyan (Speed)</div><button class="btn" onclick="setSkin('cyan')">EQUIP</button></div>
        <div class="row"><div>Ghostly (Crit)</div><button class="btn" onclick="setSkin('ghostly')">EQUIP</button></div>
        <div class="row"><div>Gold (Essence)</div><button class="btn" onclick="setSkin('gold')">EQUIP</button></div>
    </div>

    <script>
        let s = {
            e: 0, shards: 0, kills: 0,
            ev: 0, dice: 3,
            autos: [0, 0, 0], // Individual die speeds
            relics: [], relicLevels: {},
            gear: [false, false, false],
            skin: 'cyan'
        };

        const DICE_TYPES = [6, 10, 20, 50, 100];
        const RELIC_META = { "ðŸ”¥": "Infernal", "â„ï¸": "Frozen", "âš¡": "Static" };
        const COLORS = { cyan: '#00f2ff', ghostly: '#bc13fe', gold: '#ffd700' };

        function tab(t) {
            document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(x => x.classList.remove('active'));
            document.getElementById(t).classList.add('active');
            event.target.classList.add('active');
        }

        function initDice() {
            const floor = document.getElementById('dice-floor');
            floor.innerHTML = '';
            for(let i=0; i<3; i++) {
                let d = document.createElement('div');
                d.className = 'die';
                d.id = `die-${i}`;
                d.innerText = DICE_TYPES[s.ev];
                floor.appendChild(d);
            }
        }

        function rollDie(index) {
            const d = document.getElementById(`die-${index}`);
            if(!d) return;
            
            d.classList.add('rolling');
            let val = Math.floor(Math.random() * DICE_TYPES[s.ev]) + 1;
            let isCrit = Math.random() < 0.1;
            
            setTimeout(() => {
                d.classList.remove('rolling');
                d.innerText = val;
                d.className = `die ${isCrit ? 'crit' : ''}`;
                
                let critBase = s.skin === 'ghostly' ? 25 : 10;
                if(s.gear[2]) critBase *= 5;
                
                let mult = isCrit ? critBase : 1;
                // Add Relic Boosts from Forge
                Object.keys(s.relicLevels).forEach(r => mult += (s.relicLevels[r] * 0.5));

                let gain = val * mult * (s.gear[1] ? 2 : 1) * (s.skin === 'gold' ? 1.15 : 1);
                s.e += gain;
                updateUI();
            }, 100);
        }

        function manualRoll() { rollDie(0); rollDie(1); rollDie(2); }

        function buy(type) {
            let costs = { 
                ev: 1000 * Math.pow(10, s.ev),
                a1: 500 * Math.pow(2, s.autos[0]),
                a2: 5000 * Math.pow(2, s.autos[1]),
                a3: 50000 * Math.pow(2, s.autos[2])
            };

            let cost = costs[type];
            if(s.e >= cost) {
                s.e -= cost;
                if(type === 'ev' && s.ev < 4) s.ev++;
                if(type === 'a1') s.autos[0]++;
                if(type === 'a2') s.autos[1]++;
                if(type === 'a3') s.autos[2]++;
                updateUI();
            }
        }

        function forgeRelic(r) {
            let cost = (s.relicLevels[r] || 1) * 5000;
            if(s.e >= cost) {
                s.e -= cost;
                s.relicLevels[r] = (s.relicLevels[r] || 0) + 1;
                updateUI();
            }
        }

        function setSkin(id) {
            s.skin = id;
            document.documentElement.style.setProperty('--active-color', COLORS[id]);
            updateUI();
        }

        function updateUI() {
            document.getElementById('essence-count').innerText = Math.floor(s.e).toLocaleString();
            document.getElementById('shard-val').innerText = s.shards;
            
            // Update Buttons
            document.getElementById('btn-ev').innerText = 1000 * Math.pow(10, s.ev);
            document.getElementById('btn-a1').innerText = 500 * Math.pow(2, s.autos[0]);
            document.getElementById('btn-a2').innerText = 5000 * Math.pow(2, s.autos[1]);
            document.getElementById('btn-a3').innerText = 50000 * Math.pow(2, s.autos[2]);

            // Forge List
            document.getElementById('forge-list').innerHTML = s.relics.map(r => `
                <div class="row">
                    <div>${RELIC_META[r]} (Lvl ${s.relicLevels[r] || 0})</div>
                    <button class="btn" onclick="forgeRelic('${r}')">${(s.relicLevels[r] || 1) * 5000}</button>
                </div>
            `).join('');

            document.getElementById('skin-buff-label').innerText = s.skin.toUpperCase();
            save();
        }

        // Logic Loops
        setInterval(() => {
            let speedMod = s.skin === 'cyan' ? 0.9 : 1;
            if(s.autos[0] > 0) rollDie(0);
        }, 2000 / (s.autos[0] || 0.001));

        setInterval(() => { if(s.autos[1] > 0) rollDie(1); }, 3000 / (s.autos[1] || 0.001));
        setInterval(() => { if(s.autos[2] > 0) rollDie(2); }, 5000 / (s.autos[2] || 0.001));

        function spawnBoss() {
            if(s.e >= 10000) {
                s.e -= 10000;
                s.shards += 5;
                if(Math.random() > 0.5) {
                    let r = Object.keys(RELIC_META)[Math.floor(Math.random()*3)];
                    if(!s.relics.includes(r)) s.relics.push(r);
                }
                updateUI();
            }
        }

        function craft(id) {
            let costs = [10, 100, 500];
            if(s.shards >= costs[id]) { s.shards -= costs[id]; s.gear[id] = true; updateUI(); }
        }

        function save() { localStorage.setItem('void_reborn', JSON.stringify(s)); }
        window.onload = () => {
            let saved = localStorage.getItem('void_reborn');
            if(saved) s = Object.assign(s, JSON.parse(saved));
            initDice();
            setSkin(s.skin);
            updateUI();
        };
    </script>
</body>
</html>